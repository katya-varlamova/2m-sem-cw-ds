# Курсовой Проект

## Формулировка

Взяв за основу лабораторные работы 2-4, реализовать Пользовательский Интерфейс, сделать свою реализацию Identity
Provider с OpenID Connect и систему для сбора статистики, которая будет доступна пользователю с правами `admin`.

## Требования к программной реализации

1. Создать сервис, выполняющий функцию Identity Provider, реализовать протокол OpenID Connect. Реализовать scope:
    * `openid` – всегда передается, в ответ возвращается JWT;
    * `profile` – базовая информация о пользователе;
    * `email` – email пользователя.
2. Для получения токена на Identity Provider реализовать Authorization Flow. UI рассматривается как 3rd party
   application и авторизация пользователя так же выполняется через Authorization Flow.
3. Все методы `/api/**` (кроме `/api/v1/authorize` и `/api/v1/callback`) на всех сервисах закрыть token-based
   авторизацией. 4Так же реализовать ролевую модель:
    * руками создать пользователя с ролью `Admin`;
    * для зарегистрированных пользователей по-умолчанию роль `User`.
5. На Identity Provider сделать возможность создания новых пользователей (запрос от пользователя с ролью `Admin`).
6. Каждый сервис при получении запроса выполняет валидацию [JWT](https://jwt.io/introduction) токена с
   помощью [JWKs](https://auth0.com/docs/security/tokens/json-web-tokens/json-web-key-sets), которые он получает из
   Identity Provider (запрос к Identity Provider делать не нужно).
7. JWT токен пробрасывать между сервисами, при получении запроса валидацию токена так же реализовать через JWKs.
8. Убрать заголовок `X-User-Name` и получать пользователя из JWT-токена.
9. Если авторизация некорректная (отсутствие токена, ошибка валидации JWT токена, закончилось время жизни токена
   (поле `exp` в payload)), то отдавать 401 ошибку.
10. Для функционала, реализованного в рамках лабораторных работ, реализовать пользовательский интерфейс как Single Page
    Application ([React](https://reactjs.org/), [Angular](https://angular.io/), [Vue](https://vuejs.org/)) или мобильный
    клиент. Использование CSS обязательно.
11. Выделить сервис статистики: в него отправлять через Kafka информацию о выполненных действиях. В зависимости от
    задания по пришедшим данным строить отчет, доступ к которому должен быть только у пользователя с ролью `Admin`.
12. Как и в [ЛР #4](https://github.com/bmstu-rsoi/lab4-template) нужно развернуть Managed Kubernetes Cluster и настроить
    Ingress Controller (для публикации сервисов наружу можно использовать _только_ Ingress).
13. Для деплоя использовать [helm charts](https://helm.sh/docs/topics/charts/), они должны быть универсальным для всех
    сервисов и отличаться лишь набором параметров запуска.
